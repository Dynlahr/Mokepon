(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function i(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(t){if(t.ep)return;t.ep=!0;const n=i(t);fetch(t.href,n)}})();const H=document.getElementById("seleccionar-ataque"),O=document.getElementById("reiniciar"),Q=document.getElementById("boton-mascota"),V=document.getElementById("boton-reiniciar");O.style.display="none";const K=document.getElementById("seleccionar-mascota"),I=document.getElementById("mascota-jugador"),W=document.getElementById("mascota-enemigo"),q=document.getElementById("vidas-jugador"),Z=document.getElementById("vidas-enemigo"),C=document.getElementById("resultado"),ee=document.getElementById("ataques-del-jugador"),oe=document.getElementById("ataques-del-enemigo"),te=document.getElementById("contenedorTarjetas"),ae=document.getElementById("contenedorAtaques"),L=document.getElementById("ver-mapa"),l=document.getElementById("mapa");let z=null,v=null,p=[],J=[],s=[],u=[],B,b,y,E,m,a,x,R=[],S,G,d=0,k=0,w=l.getContext("2d"),M,P=new Image;P.src="https://static.platzi.com/media/tmp/class-files/github/curso-programacion-basica/curso-programacion-basica-77-transmision-coordenadas/programar/mokepon/assets/mokemap.png";let U,A=window.innerWidth-20;const _=850;A>_&&(A=_-20);U=A*600/800;l.width=A;l.height=U;class g{constructor(o,i,r,t,n=null){this.id=n,this.nombre=o,this.foto=i,this.vida=r,this.ataques=[],this.ancho=80,this.alto=80,this.x=j(0,l.width-this.ancho),this.y=j(0,l.height-this.alto),this.mapaFoto=new Image,this.mapaFoto.src=t,this.velocidadX=0,this.velocidadY=0}pintarMokepon(){w.drawImage(this.mapaFoto,this.x,this.y,this.ancho,this.alto)}}let D=new g("Hipodoge","https://static.platzi.com/media/tmp/class-files/github/curso-programacion-basica/curso-programacion-basica-60-intro-canvas/programar/mokepon/assets/mokepons_mokepon_hipodoge_attack.png",5,"https://static.platzi.com/media/tmp/class-files/github/curso-programacion-basica/curso-programacion-basica-65-clases-methods/programar/mokepon/assets/hipodoge.png"),N=new g("Capipepo","https://static.platzi.com/media/tmp/class-files/github/curso-programacion-basica/curso-programacion-basica-60-intro-canvas/programar/mokepon/assets/mokepons_mokepon_capipepo_attack.png",5,"https://static.platzi.com/media/tmp/class-files/github/curso-programacion-basica/curso-programacion-basica-65-clases-methods/programar/mokepon/assets/capipepo.png"),$=new g("Ratigueya","https://static.platzi.com/media/tmp/class-files/github/curso-programacion-basica/curso-programacion-basica-60-intro-canvas/programar/mokepon/assets/mokepons_mokepon_ratigueya_attack.png",5,"https://static.platzi.com/media/tmp/class-files/github/curso-programacion-basica/curso-programacion-basica-65-clases-methods/programar/mokepon/assets/ratigueya.png");const ne=[{nombre:"ðŸ’§",id:"boton-agua"},{nombre:"ðŸ’§",id:"boton-agua"},{nombre:"ðŸ’§",id:"boton-agua"},{nombre:"ðŸ”¥",id:"boton-fuego"},{nombre:"ðŸŒ±",id:"boton-tierra"}];D.ataques.push(...ne);const ie=[{nombre:"ðŸŒ±",id:"boton-tierra"},{nombre:"ðŸŒ±",id:"boton-tierra"},{nombre:"ðŸŒ±",id:"boton-tierra"},{nombre:"ðŸ’§",id:"boton-agua"},{nombre:"ðŸ”¥",id:"boton-fuego"}];N.ataques.push(...ie);const se=[{nombre:"ðŸ”¥",id:"boton-fuego"},{nombre:"ðŸ”¥",id:"boton-fuego"},{nombre:"ðŸ”¥",id:"boton-fuego"},{nombre:"ðŸ’§",id:"boton-agua"},{nombre:"ðŸŒ±",id:"boton-tierra"}];$.ataques.push(...se);p.push(D,N,$);function ce(){H.style.display="none",L.style.display="none",p.forEach(e=>{B=`
        <input type="radio" name="mascota" id=${e.nombre} />
        <label class="tarjeta-de-mokepon" for=${e.nombre}>
            <p>${e.nombre}</p>
            <img src=${e.foto} alt=${e.nombre}>
        </label>
        `,te.innerHTML+=B,b=document.getElementById("Hipodoge"),y=document.getElementById("Capipepo"),E=document.getElementById("Ratigueya")}),Q.addEventListener("click",le),V.addEventListener("click",Ee),re()}function re(){fetch("http://192.168.0.17:8080/unirse").then(function(e){e.ok&&e.text().then(function(o){console.log(o),v=o})})}function le(){if(b.checked)I.innerHTML=b.id,m=b.id;else if(y.checked)I.innerHTML=y.id,m=y.id;else if(E.checked)I.innerHTML=E.id,m=E.id;else{alert("Selecciona una mascota");return}de(m),K.style.display="none",pe(m),L.style.display="flex",we()}function de(e){fetch(`http://192.168.0.17:8080/mokepon/${v}`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({mokepon:e})})}function pe(e){let o;for(let i=0;i<p.length;i++)e===p[i].nombre&&(o=p[i].ataques);me(o)}function me(e){e.forEach(o=>{x=`
        <button id=${o.id} class="boton-de-ataque BAtaque">${o.nombre}</button>
        `,ae.innerHTML+=x}),document.getElementById("boton-fuego"),document.getElementById("boton-agua"),document.getElementById("boton-tierra"),R=document.querySelectorAll(".BAtaque")}function ue(){R.forEach(e=>{e.addEventListener("click",o=>{o.target.textContent==="ðŸ”¥"?(s.push("FUEGO"),console.log(s),e.style.background="#112f58",e.disabled=!0):o.target.textContent==="ðŸ’§"?(s.push("AGUA"),console.log(s),e.style.background="#112f58",e.disabled=!0):(s.push("TIERRA"),console.log(s),e.style.background="#112f58",e.disabled=!0),s.length===5&&ge()})})}function ge(){fetch(`http://192.168.0.17:8080/mokepon/${v}/ataques`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({ataques:s})}),M=setInterval(he,50)}function he(){fetch(`http://192.168.0.17:8080/mokepon/${z}/ataques`).then(function(e){e.ok&&e.json().then(function({ataques:o}){o.length==5&&(u=o,be())})})}function fe(e){W.innerHTML=e.nombre,e.ataques,ue()}function h(e,o){S=s[e],G=u[o]}function be(){clearInterval(M);for(let e=0;e<s.length;e++)s[e]===u[e]?(h(e,e),f("EMPATE")):s[e]==="FUEGO"&&u[e]==="TIERRA"||s[e]==="AGUA"&&u[e]==="FUEGO"||s[e]==="TIERRA"&&u[e]==="AGUA"?(h(e,e),f("GANASTE"),d++,q.innerHTML=d):(h(e,e),f("PERDISTE"),k++,Z.innerHTML=k);ye()}function ye(){d===k?T("Esto fue un empate!!!"):d>k?T("FELICITACIONES! Ganaste :)"):T("Lo siento, perdiste :(")}function f(e){let o=document.createElement("p"),i=document.createElement("p");C.innerHTML=e,o.innerHTML=S,i.innerHTML=G,ee.appendChild(o),oe.appendChild(i)}function T(e){C.innerHTML=e,O.style.display="block"}function Ee(){location.reload()}function j(e,o){return Math.floor(Math.random()*(o-e+1)+e)}function ke(){a.x=a.x+a.velocidadX,a.y=a.y+a.velocidadY,w.clearRect(0,0,l.width,l.height),w.drawImage(P,0,0,l.width,l.height),a.pintarMokepon(),Ae(a.x,a.y),J.forEach(function(e){e.pintarMokepon(),Be(e)})}function Ae(e,o){fetch(`http://192.168.0.17:8080/mokepon/${v}/posicion`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({x:e,y:o})}).then(function(i){i.json().then(function({enemigos:r}){console.log(r),J=r.map(function(t){const n=t.mokepon.nombre||"";let c=null;return n=="Hipodoge"?c=new g("Hipodoge","https://static.platzi.com/media/tmp/class-files/github/curso-programacion-basica/curso-programacion-basica-60-intro-canvas/programar/mokepon/assets/mokepons_mokepon_hipodoge_attack.png",5,"https://static.platzi.com/media/tmp/class-files/github/curso-programacion-basica/curso-programacion-basica-65-clases-methods/programar/mokepon/assets/hipodoge.png",t.id):n=="Capipepo"?c=new g("Capipepo","https://static.platzi.com/media/tmp/class-files/github/curso-programacion-basica/curso-programacion-basica-60-intro-canvas/programar/mokepon/assets/mokepons_mokepon_capipepo_attack.png",5,"https://static.platzi.com/media/tmp/class-files/github/curso-programacion-basica/curso-programacion-basica-65-clases-methods/programar/mokepon/assets/capipepo.png",t.id):n=="Ratigueya"&&(c=new g("Ratigueya","https://static.platzi.com/media/tmp/class-files/github/curso-programacion-basica/curso-programacion-basica-60-intro-canvas/programar/mokepon/assets/mokepons_mokepon_ratigueya_attack.png",5,"https://static.platzi.com/media/tmp/class-files/github/curso-programacion-basica/curso-programacion-basica-65-clases-methods/programar/mokepon/assets/ratigueya.png",t.id)),c.x=t.x,c.y=t.y,c})})})}function ve(){a.velocidadX=5}function Me(){a.velocidadX=-5}function Ie(){a.velocidadY=5}function qe(){a.velocidadY=-5}function F(){a.velocidadX=0,a.velocidadY=0}function Te(e){switch(e.key){case"ArrowUp":qe();break;case"ArrowDown":Ie();break;case"ArrowLeft":Me();break;case"ArrowRight":ve();break}}function we(){a=Le(),console.log(a,m),M=setInterval(ke,50),window.addEventListener("keydown",Te),window.addEventListener("keyup",F)}function Le(){for(let e=0;e<p.length;e++)if(m===p[e].nombre)return p[e]}function Be(e){const o=e.y,i=e.y+e.alto,r=e.x+e.ancho,t=e.x,n=a.y,c=a.y+a.alto,Y=a.x+a.ancho,X=a.x;c<o||n>i||Y<t||X>r||(F(),clearInterval(M),console.log("Se detecto una colision"),z=e.id,H.style.display="flex",L.style.display="none",fe(e))}window.addEventListener("load",ce);
